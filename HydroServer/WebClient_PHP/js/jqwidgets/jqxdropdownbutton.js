/*
jQWidgets v2.1.0 (2012-May-04)
Copyright (c) 2011-2012 jQWidgets.
License: http://jqwidgets.com/license/
*/

(function(a){a.jqx.jqxWidget("jqxDropDownButton","",{});a.extend(a.jqx._jqxDropDownButton.prototype,{defineInstance:function(){this.disabled=false;this.width=null;this.height=null;this.arrowSize=19;this.enableHover=true;if(this.showDelay==undefined){this.showDelay=350}if(this.hideDelay==undefined){this.hideDelay=400}this.animationType="default";this.enableBrowserBoundsDetection=false;this.events=["show","hide"]},createInstance:function(h){this.isanimating=false;var c=a("<div tabIndex=0 style='background-color: transparent; -webkit-appearance: none; outline: none; width:100%; height: 100%; padding: 0px; margin: 0px; border: 0px; position: relative;'><div id='dropDownButtonWrapper' style='outline: none; background-color: transparent; border: none; float: left; width:100%; height: 100%; position: relative;'><div id='dropDownButtonContent' style='outline: none; background-color: transparent; border: none; float: left; position: relative;'/><div id='dropDownButtonArrow' style='background-color: transparent; border: none; float: right; position: relative;'/></div></div>");this.popupContent=this.host.children();if(this.popupContent.length==0){this.popupContent=a("<div>"+this.host.text()+"</div>");this.popupContent.css("display","block");this.element.innerHTML=""}else{this.popupContent.detach()}var i=this;this.addHandler(this.host,"loadContent",function(e){i._arrange()});try{var f="dropDownButtonPopup"+this.element.id;var d=a(a.find("#"+f));if(d.length>0){d.remove()}var b=a("<div class='dropDownButton' style='overflow: hidden; border-width: 1px; border-style: solid; position: absolute;' id='dropDownButtonPopup"+this.element.id+"'></div>");b.addClass(this.toThemeProperty("jqx-widget-content"));b.addClass(this.toThemeProperty("jqx-rc-all"));this.popupContent.appendTo(b);b.appendTo(document.body);this.container=b;if(this.animationType=="none"){this.container.css("visibility","hidden")}else{this.container.css("visibility","hidden")}}catch(g){}this.touch=a.jqx.mobile.isTouchDevice();this.dropDownButtonStructure=c;this.host.append(c);this.dropDownButtonWrapper=this.host.find("#dropDownButtonWrapper");this.dropDownButtonArrow=this.host.find("#dropDownButtonArrow");this.dropDownButtonContent=this.host.find("#dropDownButtonContent");this.dropDownButtonContent.addClass(this.toThemeProperty("jqx-dropdownlist-content"));this.dropDownButtonWrapper.addClass(this.toThemeProperty("jqx-disableselect"));this.addHandler(this.dropDownButtonWrapper,"selectstart",function(){return false});this.dropDownButtonWrapper[0].id="dropDownButtonWrapper"+this.element.id;this.dropDownButtonArrow[0].id="dropDownButtonArrow"+this.element.id;this.dropDownButtonContent[0].id="dropDownButtonContent"+this.element.id;var k=this;this.propertyChangeMap.disabled=function(e,m,l,n){if(n){e.host.addClass(k.toThemeProperty("jqx-dropdownlist-state-disabled"));e.host.addClass(k.toThemeProperty("jqx-fill-state-disabled"));e.dropDownButtonContent.addClass(k.toThemeProperty("jqx-dropdownlist-content-disabled"))}else{e.host.removeClass(k.toThemeProperty("jqx-dropdownlist-state-disabled"));e.host.removeClass(k.toThemeProperty("jqx-fill-state-disabled"));e.dropDownButtonContent.removeClass(k.toThemeProperty("jqx-dropdownlist-content-disabled"))}};if(this.disabled){this.host.addClass(this.toThemeProperty("jqx-dropdownlist-state-disabled"));this.host.addClass(this.toThemeProperty("jqx-fill-state-disabled"));this.dropDownButtonContent.addClass(this.toThemeProperty("jqx-dropdownlist-content-disabled"))}this.host.addClass(this.toThemeProperty("jqx-widget"));this.host.addClass(this.toThemeProperty("jqx-widget-content"));this.host.addClass(this.toThemeProperty("jqx-dropdownlist-state-normal"));this.host.addClass(this.toThemeProperty("jqx-rc-all"));this.host.addClass(this.toThemeProperty("jqx-fill-state-normal"));this.dropDownButtonArrow.addClass(this.toThemeProperty("icon-arrow-down"));this._setSize();this.render();if(a.browser.msie&&a.browser.version<8){this.container.css("display","none");if(this.host.parents(".jqx-window").length>0){var j=this.host.parents(".jqx-window").css("z-index");b.css("z-index",j+10);this.container.css("z-index",j+10)}}},setContent:function(b){this.dropDownButtonContent.children().remove();this.dropDownButtonContent[0].innerHTML="";this.dropDownButtonContent.append(b)},getContent:function(){if(this.dropDownButtonContent.children().length>0){return this.dropDownButtonContent.children()}return this.dropDownButtonContent.text()},_setSize:function(){if(this.width!=null&&this.width.toString().indexOf("px")!=-1){this.host.width(this.width)}else{if(this.width!=undefined&&!isNaN(this.width)){this.host.width(this.width)}}if(this.height!=null&&this.height.toString().indexOf("px")!=-1){this.host.height(this.height)}else{if(this.height!=undefined&&!isNaN(this.height)){this.host.height(this.height)}}var d=false;if(this.width!=null&&this.width.toString().indexOf("%")!=-1){d=true;this.host.width(this.width)}if(this.height!=null&&this.height.toString().indexOf("%")!=-1){d=true;this.host.height(this.height)}if(d){this.refresh(false);var c=this;var b=this.host.width();a(window).resize(function(){c._arrange()})}},isOpened:function(){var c=this;var b=a.data(document.body,"openedJQXButton"+this.element.id);if(b!=null&&b==c.popupContent){return true}return false},render:function(){var b=this;var c=false;if(!this.touch){this.host.hover(function(){if(!b.disabled&&b.enableHover){c=true;b.host.addClass(b.toThemeProperty("jqx-dropdownlist-state-hover"));b.dropDownButtonArrow.addClass(b.toThemeProperty("icon-arrow-down-hover"));b.host.addClass(b.toThemeProperty("jqx-fill-state-hover"))}},function(){if(!b.disabled&&b.enableHover){b.host.removeClass(b.toThemeProperty("jqx-dropdownlist-state-hover"));b.host.removeClass(b.toThemeProperty("jqx-fill-state-hover"));b.dropDownButtonArrow.removeClass(b.toThemeProperty("icon-arrow-down-hover"));c=false}})}this.addHandler(this.dropDownButtonWrapper,"mousedown",function(f){if(!b.disabled){var e=b.container.css("visibility")=="visible";if(!b.isanimating){if(e){b.hide()}else{b.show()}}}});this.addHandler(a(document),"mousedown."+this.element.id,b.closeOpenedDropDown,{me:this,popup:this.container,id:this.element.id});if(window.frameElement){if(window.top!=null){var d=function(e){if(b.isOpened()){var f={me:b,popup:b.container,id:b.element.id};e.data=f}};if(window.top.document.addEventListener){window.top.document.addEventListener("mousedown",d,false)}else{if(window.top.document.attachEvent){window.top.document.attachEvent("onmousedown",d)}}}}this.addHandler(this.host,"keydown",function(f){var e=b.container.css("visibility")=="visible";if(b.host.css("display")=="none"){return true}if(f.keyCode=="13"){if(!b.isanimating){if(e){b.hide();if(!b.keyboardSelection){b._raiseEvent("2",{index:b.selectedIndex,type:"keyboard",item:b.getItem(b.selectedIndex)})}}else{b.show()}}}if(f.keyCode==115){if(!b.isanimating){if(!b.isOpened()){b.show()}else{if(b.isOpened()){b.hide()}}}return false}if(f.altKey){if(b.host.css("display")=="block"){if(f.keyCode==38){if(b.isOpened()){b.hide()}}else{if(f.keyCode==40){if(!b.isOpened()){b.show()}}}}}if(f.keyCode=="27"){if(!b.ishiding){b.hide();if(b.tempSelectedIndex!=undefined){b.selectIndex(b.tempSelectedIndex)}}}});this.addHandler(this.host.find("div:first"),"focus",function(){b.host.addClass(b.toThemeProperty("jqx-dropdownlist-state-focus"));b.host.addClass(b.toThemeProperty("jqx-fill-state-focus"))});this.addHandler(this.host.find("div:first"),"blur",function(){b.host.removeClass(b.toThemeProperty("jqx-dropdownlist-state-focus"));b.host.removeClass(b.toThemeProperty("jqx-fill-state-focus"))})},removeHandlers:function(){var b=this;this.removeHandler(this.dropDownButtonWrapper,"mousedown");this.removeHandler(this.host,"keydown");this.removeHandler(this.host.find("div:first"),"focus");this.removeHandler(this.host.find("div:first"),"blur");this.host.unbind("hover")},_findPos:function(c){while(c&&(c.type=="hidden"||c.nodeType!=1||a.expr.filters.hidden(c))){c=c.nextSibling}var b=a(c).offset();return[b.left,b.top]},testOffset:function(d,h,f){var g=d.outerWidth();var c=d.outerHeight();var e=document.documentElement.clientWidth+a(window).scrollLeft();var b=document.documentElement.clientHeight+a(window).scrollTop();h.left-=0;h.left-=0;h.top-=0;h.left-=Math.min(h.left,(h.left+g>e&&e>g)?Math.abs(h.left+g-e):0);h.top-=Math.min(h.top,(h.top+c>b&&b>c)?Math.abs(c+f):0);return h},show:function(){var l=this;var b=this.popupContent;var i=a(window).scrollTop();var f=a(window).scrollLeft();var h=parseInt(this._findPos(this.host[0])[1])+parseInt(this.host.outerHeight())-1+"px";var d=parseInt(this.host.offset().left)+"px";var k=a.jqx.mobile.isSafariMobileBrowser();this.ishiding=false;this.tempSelectedIndex=this.selectedIndex;if(k!=null&&k){d=a.jqx.mobile.getLeftPos(this.element);h=a.jqx.mobile.getTopPos(this.element)+parseInt(this.host.outerHeight())}b.stop();this.host.addClass(this.toThemeProperty("jqx-dropdownlist-state-selected"));this.host.addClass(this.toThemeProperty("jqx-fill-state-pressed"));this.dropDownButtonArrow.addClass(this.toThemeProperty("icon-arrow-down-selected"));var e=false;if(a.browser.msie&&a.browser.version<8){e=true}if(e){this.container.css("display","block")}this.container.css("left",d);this.container.css("top",h);var c=true;if(this.enableBrowserBoundsDetection){var g=this.testOffset(b,{left:parseInt(this.container.css("left")),top:parseInt(h)},parseInt(this.host.outerHeight()));this.container.css("top",g.top)}if(this.animationType=="none"){this.container.css("visibility","visible");a.data(document.body,"openedJQXButtonParent",l);a.data(document.body,"openedJQXButton"+this.element.id,b)}else{this.container.css("visibility","visible");var j=b.outerHeight();l.isanimating=true;b.css("margin-top",-j);b.animate({"margin-top":0},this.showDelay,function(){a.data(document.body,"openedJQXButtonParent",l);a.data(document.body,"openedJQXButton"+l.element.id,b);l.ishiding=false;l.isanimating=false})}},hide:function(){var e=this.popupContent;var d=this.container;var f=this;var c=false;if(a.browser.msie&&a.browser.version<8){c=true}a.data(document.body,"openedJQXButton"+this.element.id,null);if(this.animationType=="none"){this.container.css("visibility","hidden");if(c){this.container.css("display","none")}}else{if(!f.ishiding){f.isanimating=true;e.stop();var b=e.outerHeight();e.css("margin-top",0);e.animate({"margin-top":-b},this.hideDelay,function(){d.css("visibility","hidden");f.isanimating=false;f.ishiding=false;if(c){d.css("display","none")}})}}this.ishiding=true;this.host.removeClass(this.toThemeProperty("jqx-dropdownlist-state-selected"));this.host.removeClass(this.toThemeProperty("jqx-fill-state-pressed"));this.dropDownButtonArrow.removeClass(this.toThemeProperty("icon-arrow-down-selected"))},closeOpenedDropDown:function(e){var c=e.data.me;var b=a(e.target);if(a(e.target).ischildof(e.data.me.host)){return true}var f=c;var d=false;a.each(b.parents(),function(){if(this.className!="undefined"){if(this.className.indexOf("dropDownButton")!=-1){d=true;return false}}});if(!d){c.hide()}return true},refresh:function(){this._arrange()},_arrange:function(){var f=parseInt(this.host.width());var b=parseInt(this.host.height());var e=this.arrowSize;var d=this.arrowSize;var g=3;var c=f-d-2*g;if(c>0){this.dropDownButtonContent.width(c+"px")}this.dropDownButtonContent.height(b);this.dropDownButtonContent.css("left",0);this.dropDownButtonContent.css("top",0);this.dropDownButtonArrow.width(d);this.dropDownButtonArrow.height(b)},destroy:function(){this.removeHandler(this.dropDownButtonWrapper,"selectstart");this.removeHandler(this.dropDownButtonWrapper,"mousedown");this.removeHandler(this.host,"keydown");this.host.removeClass();this.removeHandler(a(document),"mousedown."+this.element.id,self.closeOpenedDropDown);this.host.remove()},_raiseEvent:function(f,c){if(c==undefined){c={owner:null}}var d=this.events[f];args=c;args.owner=this;var e=new jQuery.Event(d);e.owner=this;if(f==2||f==3||f==4){e.args=c}var b=this.host.trigger(e);return b},propertyChangedHandler:function(b,c,e,d){if(this.isInitialized==undefined||this.isInitialized==false){return}if(c=="theme"&&d!=null){a.jqx.utilities.setTheme(e,d,b.host)}if(c=="width"||c=="height"){b._setSize();b._arrange()}}})})(jQuery);